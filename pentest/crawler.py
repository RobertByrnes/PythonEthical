#! usr/bin/env python
import requests


def request(url):
    try:
        return requests.get("http://" + url)
    except requests.exceptions.ConnectionError:
        pass
    except requests.exceptions.MissingSchema:
        pass
    except requests.exceptions.InvalidURL:
        pass


target_url = "hawksmoorim.co.uk"
subdomains_list = []
directories_list = []
output_list = []


def find_subdomains(url, subdomains):
    with open("dictionary/subdomain_long.txt", "r") as wordlist_file:
        for line in wordlist_file:
            word = line.strip()
            test_url = word + "." + url
            response = request(test_url)
            if response:
                print("[+] Subdomain >>> " + test_url + " >>> " + str(response))
                subdomains.append(test_url)
    return subdomains


def find_directories(subdomains, directories, output):
    with open("dictionary/common.txt", "r") as wordlist_file:
        for url in subdomains:
            for line in wordlist_file:
                word = line.strip()
                test_url = url + "/" + word
                response = request(test_url)
                if response:
                    print("[+] Directory >>> " + test_url + " >>> " + str(response))
                    directories.append(test_url)
        for url in directories:
            for line in wordlist_file:
                word = line.strip()
                test_url = url + "/" + word
                response = request(test_url)
                if response:
                    print("[+] Sub-Directory or file >>> " + test_url + " >>> " + str(response))
                    output.append(test_url)
    return output


subdomain_names = find_subdomains(target_url, subdomains_list)
full_list = find_directories(subdomain_names, directories_list, output_list)
